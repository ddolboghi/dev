# 코드 표현(expression)이란?
스캐닝으로 소스 코드 문자열을 토큰으로 변환 후, 더 복잡한 표현(representation)으로 바꾸는 파서를 만들어야 한다.
파서를 만들기 전에 먼저 표현을 정의해야 한다. 코드 표현은 이 표현을 뜻한다.

코드 표현이 갖춰야 할 조건은 다음과 같다:
- 파서가 만들기 간단해야 한다.
- 인터프리터가 소비하기 쉬워야 한다.

트리 구조로 코드를 쉽게 표현할 수 있다. 물론 코드를 표현하는 유일한 방법이 트리라는 말은 아니다.
# 컨텍스트 자유 문법(CFG, Context-Free Grammar)
- 형식 문법(formal grammar)은 알파벳이라는 원자적 조각들의 집합을 받아 문법에 있는 (대부분 무한한)문자열의 집합을 정의한다. 즉, 어떤 문자열이 올바른 문법인지 가려낸다.
	- 예를 들어, Python 문법을 정한다고 가정하면 `if 0 == False: return True`는 문법에 맞지만, `if 0 is False: return True`는 피연산자 타입에 적절하지 않은 비교 연산자를 사용하므로 잘못된 표현이다.
- 구문 문법은 렉시컬 문법보다 한 단계 상위 문법이라고 보면 된다.
	- 렉시컬 문법에서 '알파벳'이 문자(e.g. `a`)였다면, 구문 문법에서는 토큰(e.g. `and`)이다.
	- 렉시컬 문법에서 '문자열'이 토큰(e.g. `and`)였다면, 구문 문법에서는 표현식(e.g. `if a and b`)이다.
	- 렉시컬 문법은 **스캐너**에 의해 구현되고, 구문 문법은 **파서**에 의해 구현된다.
## 문법 규칙
- 유한한 문법 규칙 집합을 만들고 이 규칙을 이용해서 문법에 맞는 문자열을 만든다.
- **derivation(파생어)**: 규칙 집합으로 만들어진 문자열이다.
- **production**: 문법에 맞는 문자열을 생성하는 규칙이다. 프로덕션에는 **head(이름)** 와 생성한 결과물을 설명하는 **body**가 있다. 순수한 형태의 body는 symbol(기호) 리스트에 불과하다.
- **symbol**: 문법을 구성하는 원소다.
	- **terminal**: 실제 문자열에 나타나는 기호다. 스캐너가 내보낸 개별 lexeme, 즉 토큰이다.
	- **non-terminal**: 문법 구조를 나타내는 기호다. 다른 문법 규칙을 가리키는 기명 참조(named reference)로, 규칙에 따라 생성되는 모든 것을 특정 기호로 표현한 것이다. 실제 출력 문자열에는 직접 등장하지 않는 중간 단계의 추상적인 구조다.
- 컨텍스트 자유 문법에서는 head를 단 하나의 non-terminal 기호로 제한한다.
- 무제한 문법(unrestricted grammar)에서는 body 뿐만 아니라 head에서도 한 개 이상의 심볼을 허용한다.
- **BNF(Backus-Naur) 표기법**: 구문 정의 규칙에 사용되는 구문에 대한 정의다. 즉, 문법을 체계적으로 표현하는데 사용되는 표기법이다.
### 변형된 BNF 표기법으로 작성한 문법 규칙 예시
```
# 규칙 이름 다음에 → 와 여러 심볼들이 나오고 마지막은 ;으로 끝난다.
# terminal은 큰따옴표로 싸인 문자열이고, non-terminal은 소문자 단어로 표기한다.

breakfast → protein "with" breakfast "on the side" ;
breakfast → bread ;
protein → cooked "eggs" ;
cooked → "poached" ;
bread → "toast" ;
```
- 컨텍스트 자유 언어는 위 예시의 첫번째 문법처럼 문법에서 재귀가 나타난다.
- 재귀적 non-terminal 양쪽에 production이 있는 상태에서 재귀는 정규 언어가 아님을 의미한다.
- 문자열의 모든 non-terminal이 terminal만 포함될 때까지 확장한다.
#### 표기법 개선
- production에 여러 개의 body를 넣을때 `|`로 구분한다.
- `()`로 묶은 body는 그 중 하나를 고를 수 있다는 의미다.
- 심볼에 접미어 `*`를 붙이면 0회 이상 반복을 의미한다.
- 심볼에 접미어 `+`를 붙이면 1회 이상 반복을 의미한다.
- 심볼에 접미어 `?`를 붙이면 선택적인 production임을 의미한다.
```
breakfast → protein ("with" breakfast "on the side")?
			| bread ;
protein → "poached" "eggs" ;
bread → "toast" ;
```
#### lox 표현식에 대한 문법 정의
```
expression → literal
			| unary # 단항식
			| binary # 이항식
			| grouping ;
literal → NUMBER | STRING | "true" | "false" | "nil" ;
grouping → "(" expression ")"
unary → ("-" | "!") expression ;
bynary → expression operation expression ;
operation → "==" | "!=" | "<" | "<=" | ">" | ">=" | "+" | "-" | "*" | "/" ;
```
- lexeme과 정확히 매치되는 terminal 문자열은 따옴표로 감쌌다.
- 텍스트 표현이 달라질 수 있는 lexeme은 대문자로 표기했다.
# 구문 트리
- 문법 규칙을 트리 구조로 나타낸 것을 구문 트리라고 한다.
- 