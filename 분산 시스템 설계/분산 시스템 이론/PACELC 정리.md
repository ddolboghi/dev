- 네트워크 파티션이 발생했을때 CAP의 한계점을 보완하는 개념으로, 더 넓은 경우의 수를 포함합니다.
- Partition tolerance
- Availability
- Consistency
- Else: **네트워크 파티션이 발생하지 않는 상황**을 의미합니다. 이때 **지연 시간과 일관성 중 하나를 선택**해야 합니다.
- Latency: 요청을 시작하고 응답을 받기까지 지연된 시간을 의미합니다.. 지연 시간을 짧아지도록 설계하면 일관성이 떨어지거나 가용성이 줄어들 수도 있습니다.
- Consistency level: 일관성의 정도를 나타냅니다. 이는 애플리케이션 요구 사항이나 시스템 설계 방향에 따라 달라질 수 있습니다.
# 합의(Consensus)
- 합의란 분산 시스템에서 서로 다른 서버들이 동일한 상태나 결정을 유지하도록 하는 과정입니다.
- 각 서버가 독립적으로 작동하면 동일한 데이터에 대해 서로 다른 작업을 수행할 수 있습니다.
	- 한 서버가 정보를 업데이트하는 동안 다른 서버는 이전 정보를 기준으로 작업을 계속하면 데이터 불일치가 발생합니다.
- 합의 알고리즘은 **모든 노드가 동일한 결정을 내리도록 동기화**하여 데이터 일관성을 유지합니다.
## 팩소스 알고리즘
- 분산 시스템에서 여러 문제가 발생해도 하나의 값을 도출할 수 있도록 합의합니다.
- 하나의 값이란, 모든 노드가 동의해야 하는 특정 데이터나 결정을 의미합니다.
- 여러 노드가 동일한 데이터를 서로 다른 값으로 업데이트하려는 상황해서 여러 단계의 통신을 거쳐 각 노드가 하나의 값으로 일치할 수 있도록 합의하는 프로토콜을 사용합니다.
### 구성 요소
- **제안자(proposer)**: 합의 프로세스를 시작하는 노드입니다. 제안자는 합의해야 할 값을 제안하고, 이 제안을 다른 노드에 전파합니다.
- **수용자(acceptor)**: 제안자에게서 제안을 받고, 제안이 수용되었는지 다른 노드에 알립니다.
- **학습자(learner)**: 합의된 값을 최종적으로 받는 노드입니다. 학습자는 이 값을 기반으로 후속 작업을 수행합니다.
### 프로토콜 과정
1. 제안자가 고유한 제안 번호를 선택해서 가능한 한 많은 수용자에게 준비 요청을 보냅니다.
2. 수용자는 자신이 수용한 제안 중 가장 높은 번호의 제안을 응답으로 반환합니다.
3. 제안자가 제안 번호와 값을 담아 수용자들에게 최종 수용 요청을 보냅니다.
4. 수용자들이 제안을 수용하면 합의됩니다.
5. 학습자들은 최종 결정된 제안을 전달 받아 작업을 수행합니다.
	1. 네트워크 오류 등으로 인해 응답하지 못한 수용자는 학습자가 되어 최종 제안에 대한 작업을 수행합니다.

#### 경합 상황
1. 노드 A가 노드 B, C, D에 제안하고, 모두 이 제안을 받아들입니다.
2. 노드 A가 최종 수용 요청을 보내기 전에 노드 B가 더 높은 제안 번호로 노드 A, C, D에 제안합니다.
3. 노드 C, D는 더 높은 제안 번호를 가진 제안을 선택합니다.
4. 노드 A는 자신의 제안이 거부되었음을 알게 됩니다.
5. 노드 A는 더 높은 제안 번호로 새로운 제안을 합니다.

**다음 제안을 할 때 더 높은 제안 번호를 사용하므로 하나의 합의에 도달할 수 있습니다.**
### 고려사항
- 장애 허용성: 일부 노드가 작동하지 않거나 네트워크 파티션이 발생해도 시스템이 작동해야 합니다.
- 확장성: 노드가 많아질 수록 조율과 통신 부담이 증가하여 성능이 떨어질 수 있습니다.
- 복잡성: 모든 참여자가 프로토콜을 정확하게 따를 수 있게 설계해야 합니다.
### 최적화 기법
