# 네트워크 계층의 핵심 기능
네트워크 계층의 주된 역할은 패킷을 송신 호스트에서 수신 호스트로 이동시키는 것이다. 이를 위해 두 가지 중요한 기능이 있다.
## Forwarding
- 정의: 패킷이 라우터의 입력 링크에 도착했을 때, 라우터가 그 패킷을 적절한 출력 링크로 이동시키는 router-local 동작이다. 예를 들어, 송신 호스트에서 첫번째 인접 라우터로 도착한 패킷은 수신 호스트로 가는 경로상의 다음 라우터로 포워딩되어야 한다.
- 역할: 포워딩은 데이터 플레인(data plane)에서 수행되는 핵심 기능이다.
- 시간 척도: 매우 짧은 시간(ns)에 발생하며, 하드웨어로 구현된다.
## Routing
- 정의: 패킷이 송신자에서 수신자로 이동할 때 거치는 경로를 결정하는 network-wide 프로세스다. 경로를 계산하는 알고리즘을 라우팅 알고리즘이라고 한다.
- 역할: 라우팅은 컨트롤 플레인(control plane)에서 수행되는 기능이다.
- 시간 척도: 포워딩보다 훨씬 긴 시간(s)에 걸쳐 발생하며, 소프트웨어로 구현되는 경우가 많다.

> [!NOTE]
    > 모든 네트워크 라우터의 핵심 요소는 **포워딩 테이블(forwarding table)** 이다. 
    > 라우터는 도착하는 패킷 헤더의 필드 값을 조사하고, 이 값을 포워딩 테이블의 인덱스로 사용하여 패킷을 전달할 출력 링크 인터페이스를 결정한다. 이 포워딩 테이블의 내용은 라우팅 알고리즘에 의해 결정된다.
    
## Control plane(제어 평면) 접근 방식
포워딩 테이블이 어떻게 구성되는지에 따라 제어 평면의 방식이 나뉜다.
### 전통적인 접근 방식
![[forward_tables.png | 500]]
- 라우팅 알고리즘이 각 라우터 내에서 실행된다.
- 포워딩과 라우팅 기능이 모두 라우터 내에 포함되어있다.
- 한 라우터의 라우팅 알고리즘 기능은 다른 라우터의 라우팅 알고리즘 기능과 통신하여 자신의 포워딩 테이블 값을 계산한다. 이 통신은 라우팅 프로토콜에 따라 라우팅 메시지를 교환함으로써 이뤄진다.
### SDN(Software-Defined Networking) 접근 방식
![[forward_tables_by_sdn.png | 550]]
- 물리적으로 분리된 원격 컨트롤러가 각 라우터에서 사용할 포워딩 테이블을 계산하고 배포한다.
- 원격 컨트롤러는 소프트웨어로 구현되기 때문에 Software-Defined Networking이라고 불린다.
- 라우터는 포워딩만 수행한다.
- 라우터와 원격 컨트롤러는 포워딩 테이블과 기타 라우팅 정보를 포함한 메시지를 교환하며 통신한다.

# 네트워크 서비스 모델
네트워크 서비스 모델은 송신 호스트와 수신 호스트 간의 종단 간 패킷 전달 특성을 정의한다.
## 네트워크 계층이 제공할 수 있는 서비스 예시
- **전달 보장**: 송신 호스트가 보낸 패킷이 결국 수신 호스트에 도착할 것을 보장한다.
- **제한된 지연 시간 내 전달 보장**: 지정된 호스트 간 지연 시간 상한 내에 전달될 것을 보장한다.
- **순서대로 패킷 전달**: 패킷이 송신된 순서대로 목적지에 도착할 것을 보장한다.
- **최소 대역폭 보장**: 이 서비스는 송신 및 수신 호스트 간에 지정된 비트율(예: 1Mbps)의 전송 링크 동작을 모방한다. 송신 호스트가 지정된 비트율 이하로 비트를 전송하는 한, 모든 패킷은 결국 수신 호스트에 전달된다.
- **보안**: 네트워크 계층은 송신 측에서 모든 데이터그램을 암호화하고 수신 측에서 복호화함으로써 모든 전송 계층 세그먼트에 대한 기밀성을 제공할 수 있다.
## 인터넷의 네트워크 서비스 모델
인터넷의 네트워크 계층은 **최선형 서비스(best-effort service)** 라는 단일 서비스를 제공한다.
- 패킷이 송신된 순서대로 수신되는 것이 보장되지 않으며, 심지어 최종 전달 자체도 보장되지 않는다. 그저 최선을 다해 전달을 시도한다.
- 종단 간 지연 시간에 대한 보장이나 최소 대역폭 보장도 없다.
- '최선형 서비스'라는 용어는 아무런 서비스도 제공하지 않는다는 것을 완곡하게 표현한 것처럼 보일 수 있다. 실제로 목적지에 패킷을 전혀 전달하지 않는 네트워크도 최선형 전달 서비스의 정의를 만족시킨다.
- 인터넷의 기본 최선형 서비스 모델은 적절한 대역폭 제공 및 대역폭 적응형 애플리케이션 계층 프로토콜(DASH 프로토콜)과 결합되어 스트리밍 비디오 서비스, 실시간 화상 회의 등의 애플리케이션을 지원하기에 "충분히 좋다"는 것이 입증되었다.