# TCP 연결의 특징
- TCP는 두 프로세스가 데이터를 교환하기 전에 먼저 서로 handshake를 해야 하는 연결 지향형 프로토콜이다.
- TCP 연결 상태는 양 끝의 종단 시스템 간에만 존재하며, 라우터들은 TCP 연결을 모르는 채로 데이터그램만 처리한다.
- **full-duplex**(전이중) 서비스: TCP 연결된 프로세스들간에는 동시에 양방향으로 데이터를 전송할 수 있다.
- **point-to-point**(점대점): 단일 송신자와 단일 수신자만 있다. 멀티캐스팅은 TCP에서 불가능하다.
## 연결 설정 과정
클라이언트 애플리케이션 프로세스가 클라리언트 측 TCP에게 서버의 특정 프로세스와 연결하고 싶다고 알린다.
### 3-way handshake
1. 클라이언트는 특별한 TCP 세그먼트를 서버에 전송한다.
2. 서버는 두 번째 특별한 TCP 세그먼트로 응답한다.
3. 클라이언트가 세 번째 특별한 세그먼트로 응답한다.

처음 두 세그먼트는 애플리케이션 게층 데이터(페이로드)를 포함하지 않으며, 세 번째 세그먼트에는 페이로드를 포함할 수 있다.
## 데이터 전송과 버퍼
- 클라이언트의 TCP는 데이터를 **송신 버퍼(send buffer)** 로 보낸다.
- 송신 버퍼는 3-way handshake 과정에서 할당된 공간이다.
- TCP는 때때로 송신 버퍼에서 데이터 덩어리를 가져와 네트워크 계층으로 전달한다.
- TCP는 데이터의 각 덩어리를 TCP 헤더와 결합하여 TCP 세그먼트를 만든다.
- 세그먼트들은 네트워크 계층으로 전달되어 IP 데이터그램 내에 각각 캡슐화된 후 네트워크로 전송된다.
- 수신측 TCP가 세그먼트를 받으면, 세그먼트의 데이터를 TCP 연결의 **수신 버퍼(receive buffer)** 에 넣는다.
- 애플리케이션은 소켓을 통해 수신 버퍼에서 데이터 스트림을 읽는다.
- TCP로 연결된 양측은 각각 자신만의 송신 버퍼와 수신 버퍼를 가진다.
### 최대 세그먼트 크기(Maximum Segment Size, MSS)
- TCP가 세그먼트에 한 번에 넣을 수 있는 최대 데이터량
- 송신측에서 보낼 수 있는 가장 큰 링크 계층 프레임의 길이(Maximum Transmission Unit, MTU)에 맞춰 설정된다.
  예를 들어, 이더넷과 PPP 프로토콜은 MTU가 1,500byte이므로, 일반적인 MSS 값은 IP 헤더 20byte +TCP 헤더 20byte를 제외한 1460byte다.
