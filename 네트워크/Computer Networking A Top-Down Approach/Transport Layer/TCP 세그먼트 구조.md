- TCP 세그먼트는 **헤더 필드**와 **데이터 필드**로 구성된다.
- 데이터 필드는 애플리케이션 데이터 덩어리를 포함하며, MSS에 의해 크기가 제한된다.
- TCP 헤더는 일반적으로 20byte다.

# 주요 헤더 필드
![[TCP_segment_structure.png | 600]]
- 출발지 포트 번호와 목적지 포트 번호 필드: UDP와 마찬가지로 상위 계층에 있는 애플리케이션에 데이터를 다중화/역다중화하기 위해 사용된다.
- 체크섬 필드(Internet checksum)
- 32-bit sequence number 필드, 32-bit acknowledgment number 필드: TCP 송신자와 수신자신뢰성있는 데이터 전송 서비스를 구현하는데 사용된다.
- 16-bit 수신 윈도우 필드: 흐름 제어에 사용되며, 수신자가 수용할 수 있는 바이트 수를 나타낸다.
- 4-bit 헤더 길이 필드: TCP 헤더 길이를 32bit로 지정한다. 옵션 필드 때문에 가변적일 수 있다. 옵션 필드가 비어있으면 일반적인 헤더 길이가 된다.
- 옵션 필드: 가변 길이의 선택적 필드로, 송신자와 수신자가 MSS를 협상하거나 고속 네트워크에서 윈도우 크기 조절 인자로 사용된다.
- 플래그 필드: 6bit로 구성된다.
	- **ACK**: 확인 응답 필드의 값이 유효함을 나타낸다.
	- **RST**, **SYN**, **FIN**: 연결 설정 및 해제에 사용된다.
	- **CWR**, **ECE**: 명시적 혼잡 알림에 사용된다.
	- **PSH**: 수신자가 데이터를 즉시 상위 계층으로 전달해야 함을 나타낸다.
	- **URG**: 세그먼트에 긴급(urgent) 데이터가 있음을 나타낸다.
- 긴급 데이터 포인터 필드(Urgent data pointer field): URG 비트가 설정되었을 때 긴급 데이터의 마지막 byte 위치를 가리킨다.
# Sequence Number & ACK Number
TCP는 데이터를 구조화되지 않은 순서있는 **바이트 스트림**으로 간주한다. 따라서 sequence number는 전송된 세그먼트의 순서가 아닌, 전송된 바이트 스트림을 기준으로 메겨진다.

세그먼트의 sequence number는 **해당 세그먼트에 포함된 데이터의 첫 번째 바이트가 전체 데이터 스트림에서 몇 번째 바이트인지**를 나타낸다.

A, B가 TCP 연결