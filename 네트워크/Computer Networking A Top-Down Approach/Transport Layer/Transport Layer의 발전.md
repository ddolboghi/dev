애플리케이션에 필요한 전송 서비스가 UDP나 TCP 서비스 모델과 정확히 맞지 않는 경우가 있다. 예를 들어, 애플리케이션이 UDP보다는 더 많은 서비스를 필요로 하지만 TCP가 제공하는 모든 특정 기능을 원하지 않거나, TCP가 제공하는 것과는 다른 서비스를 원할 수 있다. 이 경우, 애플리케이션 설계자들은 애플리케이션 계층에서 직접 프로토콜을 "만들어 쓸" 수 있다. QUIC 프로토콜이 바로 이러한 접근 방식을 취한 사례이다.
# QUIC: Quick UDP Internet Connections
- QUIC는 안전한 HTTP를 위한 전송 계층 서비스의 성능을 개선하기 위해 처음부터 설계된 새로운 애플리케이션 계층 프로토콜이다.
- QUIC는 **UDP를 기본 전송 계층 프로토콜로 사용하는 애플리케이션 계층 프로토콜**이며, HTTP/2의 진화된 단순화 버전 위에서 인터페이스하도록 설계되었다.
- QUIC의 혼잡 제어는 TCP Reno를 약간 수정한 TCP NewReno를 기반으로 한다.
![[quic.png | 500]]
a: 전통적인 보안 HTTP 프로토콜 스택
b: 보안 QUIC 기반 HTTP/3 프로토콜 스택
### 연결 지향 및 보안
- QUIC는 TCP와 마찬가지로 연결 상태를 설정하기 위해 종단점 간의 hand shake가 필요하다.
- 뎐결 상태 정보에는 출발지 및 목적지 연결 ID가 포함된다.
- 모든 QUIC 패킷은 암호화된다.
- 연결 상태 설정을 위한 hand shake와 인증 및 암호화를 위한 hand shake를 결합하여 TCP 위에 TLS를 사용하는 것 보다 더 빠른 연결 설정을 제공한다.
### 스트림
- 스트림은 두 QUIC 종단점 간에 신뢰성있고 순서대로 양방향으로 데이터를 전달하기 위한 추상화 개념이다. HTTP/3에서는 웹 페이지의 각 객체가 서로 다른 스트림이 된다.
- 여러 개의 다른 애플리케이션 수준 스트림을 단일 QUIC 연결을 통해 다중화(multiplex)할 수 있게 한다.
- 일단 QUIC 연결이 설정되면 새로운 스트림을 신속하게 추가할 수 있다.
- 각 QUIC 연결에는 연결 ID가 있고, 연결 내의 각 스트림에는 스트림 ID가 있으며, 이 두 ID는 모두 QUIC 패킷 헤더에 포함된다.
- 여러 스트림의 데이터가 단일 QUIC 세그먼트에 포함될 수 있으며, 이는 UDP를 통해 전송된다.
### 신뢰성 있고 TCP 친화적인 혼잡 제어 데이터 전송
![[QUIC_reliable.png]]
a: 단일 TCP 연결을 통해 여러 HTTP 요청을 보내는 HTTP/1.1
b: 각 스트림에 대해 개별적으로 신뢰성 있는 데이터 전송을 제공하는 QUIC

- TCP의 **HOL(Head-of-Line) 블로킹**: TCP는 신뢰성있고 순서대로 데이터를 전달하기 때문에 하나의 HTTP 요청에서 데이터가 손실되면, 나머지 HTTP 요청은 손실된 데이터가 재전송되어 HTTP 서버의 TCP에 의해 올바르게 수신될 때까지 전달될 수 없다.

- QUIC의 스트림 다중화를 통한 HOL 블로킹 문제 해결: QUIC는 스트림별로 신뢰성 있는 순차 전달을 제공하므로, UDP 세그먼트 손실은 해당 세그먼트에 담겨 있던 스트림에만 영향을 미친다. 다른 스트림의 HTTP 메시지는 계속해서 수신되어 애플리케이션에 전달될 수 있다. 
- QUIC는 TCP와 유사한 확인응답(acknowledgment) 메커니즘을 사용하여 신뢰성 있는 데이터 전송을 제공한다.
