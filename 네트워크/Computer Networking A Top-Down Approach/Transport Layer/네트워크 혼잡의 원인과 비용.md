# 시나리오1: 발신지 2개, 무한 버퍼 라우터 1개
### 환경
![[congestion_scenario1.png]]
- 두 호스트 A, B는 각각 평균 $\lambda_{in}$ byte/sec의 속도로 데이터를 전송한다.
- 이 데이터는 재전송하지 않은 원본 데이터다.
- 라우터는 용량이 R인 하나의 공유 출력 링크를 가지며, 버퍼 크기는 무한하다.
### 성능 분석
![[congestion_scenario1_graph.png]]
- 처리율(throughput): 각 연결의 전송률이 R/2 미만일 때는 수신 처리율이 전송률과 동일하다($\lambda_{out} == \lambda_{in}$). 그러나 전송률이 R/2를 초과하면 수신 처리율은 R/2로 제한된다. 왜냐하면 두 호스트가 하나의 링크 용량을 공유하기 때문이다.
- 지연: 전송률이 R/2에 가까워질수록 평균 큐잉 지연은 기하급수적으로 증가한다. 전송률이 R/2를 초과하면 라우터의 큐는 무한정 길어지고, 평균 지연 시간 역시 무한대가 된다.
### 혼잡 비용
**패킷 전송률($\lambda_{in}$)이 링크 용량에 가까워질때 발생하는 막대한 큐잉 지연**
# 시나리오2: 발신지 2개, 유한 버퍼 라우터 1개
### 환경
![[congestion_scenario2.png]]
- 라우터의 버퍼 크기가 유한하다. 따라서 라우터의 버퍼가 가득 찼을때 도착하는 패킷은 손실된다.
- 각 연결은 신뢰성을 보장하며, 손실된 패킷은 재전송된다.
- $\lambda_{in}$은 애플리케이션이 전송하는 원본 데이터의 속도다.
- $\lambda'_{in}$은 재전송 데이터를 포함한 전체 트래픽이다.
### 성능 분석
![[congestion_scenario2_graph.png]]
a: 완벽한 송신 제어
- 발신지가 라우터 버퍼가 비었을 때만 패킷을 보낸다.
- 이때 패킷 손실은 발생하지 않고 $\lambda_{in} == \lambda'_{in}$이다.
- 처리율은 전송률과 같다($\lambda_{in} == \lambda_{out}$).

b: 확실한 손실 시에만 재전송
- 발신지가 타임아웃을 충분히 길게 설정하여 패킷이 확실히 손실되었을 때만 재전송한다.
- 혼잡으로 인해 손실된 패킷을 재전송해야 한다. 예를 들어, $\lambda'_{in}$이 R/2일때 $\lambda_{out}$은 R/3에 그칠 수 있다. 이는 $\lambda'_{in}$의 일부가 재전송에 사용되기 때문이다.

c: 불필요한 재전송
- 발신지가 지연된 패킷을 손실로 오인하여 이미 재전송하면 원본 패킷과 재전송된 패킷이 모두 수신지에 도달한다.
- 라우터는 불필요한 중복 패킷을 전송하는데 링크 대역폭을 낭비하게 된다.
### 혼잡 비용
- **버퍼 오버플로우로 인해 손실된 패킷 재전송**
- **긴 지연으로 인한 불필요한 재전송 때문에 라우터의 대역폭 낭비**
# 시나리오3: 발신지 4개, 유한 버퍼 라우터, 다중 홉 경로
### 환경
![[congestion_scenario3.png]]
- A -> C 연결은 라우터 R1을 D -> B 연결과 공유하고, 라우터 R2를 B -> D 연결과 공유한다.
- C -> A 연결은 라우터 R3를 B -> D 연결과 공유하고, 라우터 R4를 D -> B 연결과 공유한다.
- 모든 링크의 용량은 R로 같다.
### 성능 분석
![[congestion_scenario3_graph.png]]
- $\lambda'_{in}$이 작을 때는 처리율 $\lambda_{out}$이 $\lambda'_{in}$에 비례하여 증가한다.
- $\lambda'_{in}$이 매우 커지면, R2 라우터에서 A -> C 트래픽과 B -> D 트래픽이 버퍼 공간을 두고 경쟁한다.
- B -> D 트래픽 양이 많아질수록 A -> C 트래픽이 R2를 통과할 확률은 줄어든다.
- 극단적인 상황에서는 B -> D 트래픽이 R2의 버퍼를 계속 점유하게 되어 A -> C 연결의 처리율은 0에 수렴한다.
### 혼잡 비용
- **다중 홉 경로에서 중간 라우터에서 패킷이 손실되면, 그 패킷을 전달하기 위해 **이전 라우터들(upstream routers)이 사용한 모든 전송 용량이 낭비**된다.
