# 공정성
K개의 TCP 연결이 전송률이 R bps인 병목 링크를 공유할 때, 각 연결이 평균적으로 약 R/K의 전송률을 얻는다면, 이 혼잡 제어 메커니즘은 공정하다고 말한다.
즉, 각 연결이 링크 대역폭을 동등하게 공유하는 것이다.
# AIMD 알고리즘의 공정성
### 가정
![[TCP_fairness_ex.png | 500]]
- 두 TCP 연결은 동일한 MSS와 RTT를 갖는다.
- 두 연결은 항상 보낼 데이터가 충분하며, 느린 시작 단계는 무시하고 항상 혼잡 회피(AIMD) 모드에서 동작한다.
### 동작 분석
![[TCP_fairness_AIMD.png | 400]]
이상적으로 두 연결의 처리율 합은 R이 되어야 하고, 각 연결은 동일한 대역폭(R/2)를 가져야 한다. 이는 그래프에서 Equal bandwidth share와 Full bandwidth utilizationline의 교차점이다.
#### 수렴과정
1. 두 연결의 처리율 합이 R보다 작은 지점 A에 있다고 가정하자. 패킷 손실이 없으므로, 두 연결 모두 AIMD의 '부가적 증가' 원칙에 따라 RTT마다 윈도우 크기를 1 MSS씩 늘린다. 따라서 두 연결의 처리율은 45도 기울기로 함께 증가한다.
2. 처리율의 합이 R을 초과하면 지점 B에서 패킷 손실이 발생한다. 이때 두 연결은 '승법적 감소' 원칙에 따라 윈도우 크기를 절반으로 줄인다. 결과적으로 처리율은 원점에서 B를 잇는 벡터의 중간 지점인 C로 이동한다.
3. 지점 C에서는 다시 처리율 합이 R보다 작아지므로, 두 연결은 다시 45도 기울기로 처리율을 증가시킨다.
4. 이 과정이 반복되면서, 두 연결이 사용하는 대역폭은 결국 **'Equal bandwidth share' 선 주변에서 변동**하게 된다. 이 메커니즘은 두 연결이 어떤 초기 상태에서 시작하든 상관없이 공정한 공유 상태로 수렴하도록 만든다.
#### 현실에서의 문제
실제로는 여러 연결이 병목 링크를 공유하고 RTT 값이 다를 수 있다. 특히 RTT가 작은 연결이 가용 대역폭을 더 빨리 차지하여 RTT가 큰 연결보다 높은 처리율을 보이는 경향이 있다.
# UDP의 공정성
- TCP 혼잡 제어는 혼잡 윈도우 메커니즘을 통해 애플리케이션의 전송률을 조절한다.
- UDP는 혼잡 제어 기능이 없으므로, 네트워크가 혼잡할 때도 전송률을 줄이지 않는다.
- UDP 트래픽은 TCP 트래픽에 비해 불공정하며, TCP 트래픽을 밀어내고 네트워크 자원을 독점할 수 있다.
# 병렬 TCP의 공정성
- TCP 기반 애플리케이션이 여러 개의 병렬 TCP 연결을 사용할 수 있다. 예를 들어, 웹 브라우저는 웹 페이지 내의 여러 객첼