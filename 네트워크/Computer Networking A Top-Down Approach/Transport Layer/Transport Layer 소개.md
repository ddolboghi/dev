# Transport Layer와 Network Layer의 관계
트랜스포트 계층은 종단 시스템에 구현되있지만, 네트워크 라우터에는 없다.
트랜스포트 계층 프로토콜은 서로 다른 호스트에서 실행되는 **프로세스** 간의 논리적 통신을 제공하는 반면, 네트워크 계층 프로토콜은 **호스트** 간의 논리적 통신을 제공한다.
이 관계는 택배를 보내는 과정으로 비유할 수 있다:
- 애플리케이션 메시지: 물건을 담은 택배 상자
- 프로세스: 구매자들
- 호스트(종단 시스템): 물류창고
- 전송 계층 프로토콜: 물류장고에서 택배를 수거하고 운송하는 트럭
- 네트워크 계층 프로토콜: 판매자와 구매자 사이의 물건을 운송하는 택배 서비스

트랜스포트 계층 프로토콜은 종단 시스템 내에서만 작동하며, 메시지가 네트워크 코어를 통해 어떻게 이동하는지에 대해서는 관여하지 않는다.
네트워크의 중간 라우터들은 트랜스포트 계층이 추가한 정보를 인식하거나 처리하지 않는다.
트럭 대신 드론이 택배를 배달한다면, 서비스 모델이 달라진다. 이처럼 컴퓨터 네트워크는 각각 다른 서비스 모델을 제공하는 여러 트랜스포트 프로토콜을 이용할 수 있다.

트랜스포트 프로토콜이 제공할 수 있는 서비스는 하위 네트워크 계층 프로토콜의 서비스 모델에 의해 제약을 받는다. 예를 들어, 네트워크 계층이 지연이나 대역폭 보장을 제공하지 못하면 전송 계층도 이를 보장할 수 없다.

그럼에도 불구하고, 트랜스포트 프로토콜은 하위 네트워크 프로토콜이 제공하지 않는 특정 서비스를 제공할 수 있다. 예를 들어, 네트워크 프로토콜이 신뢰성이 없더라도 트랜스포트 프로토콜은 **신뢰성 있는 데이터 전송** 서비스를 제공할 수 있다. 또한, 네트워크 계층이 기밀성을 보장하지 않더라도 트랜스포트 프로토콜은 암호화를 통해 애플리케이션 메시지의 **기밀성**을 보장할 수 있다.

# 인터넷의 트랜스포트 계층 개요
인터넷은 애플리케이션 계층에 UDP와 TCP 트랜스포트 계층 프로토콜을 제공한다. 애플리케이션 개발자는 소켓을 생성할때 이 두 프로토콜 중 하나를 선택해야 한다.

> [!NOTE]
    > 이 책에서는 트랜스포트 계층 패킷을 **segment**라고 지칭한다. TCP 패킷은 세그먼트, UDP 패킷은 데이터그램이라고 부르기도 한다.
    
### 인터넷의 네트워크 계층 프로토콜
- 인터넷의 네트워크 계층 프로토콜은 **IP(Internet Protocol)** 라고 불리며, 호스트 간의 논리적 통신을 제공한다. 
- IP는 **최선형 전달 서비스(best-effort delivery service)** 로, IP가 세그먼트를 전달하기 위해 "최선의 노력"을 다하지만, 전달을 보장하지도, 순서를 보장하지도, 데이터 무결성을 보장하지도 않는다는 의미이다. 따라서 **IP는 신뢰할 수 없는 서비스**라고 불린다.
- 모든 호스트는 IP 주소라는 네트워크 계층 주소를 적어도 하나씩 가진다.
### UDP & TCP 특징
- **multiplexing** & **demultiplexing**:  IP의 종단 시스템 간 전달 서비스를 프로세스 간 전달 서비스로 확장하는 것이다. 
- 세그먼트 헤더에 오류 검출 필드를 포함하여 무결성 검사를 제공한다.
- UDP는 프로세스 간 데이터 전달과 오류 검사라는 두 가지 최소한의 서비스만을 제공하며, 신뢰할 수 없는 서비스이다.
- TCP는 흐름 제어, 순서 번호, 확인응답, 타이머를 사용하여 데이터가 송신 프로세스에서 수신 프로세스로 정확하고 순서대로 전달되도록 보장한다.
- TCP는 **혼잡 제어(congestion control)** 를 제공하여, 하나의 TCP 연결이 과도한 트래픽으로 네트워크를 혼잡하게 만드는 것을 방지한다.
- TCP 혼잡 제어는 혼잡한 링크를 통과하는 각 연결에 링크 대역폭의 공평한 몫을 주려고 노력한다. 반면, UDP 트래픽은 조절되지 않는다.