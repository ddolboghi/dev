# 암호화 해시 함수
- 암호화 해시 함수는 임의의 입력에 대해 고정된 크기의 해시를 생성하며, 동일한 해시 값을 갖는 서로 다른 두 메시지를 찾는 것이 계산적으로 불가능해야 한다. 즉, 동일한 해쉬 값을 갖는 다른 값을 찾을 수 없어야 한다.
- 단순한 체크섬 방식은 동일한 체크섬을 갖는 다른 메시지를 만들기 쉬워 보안용으로 부적합하다.
- 대표적인 암호화 해시 알고리즘으로는 128비트를 생성하는 MD5와 160비트를 생성하는 SHA-1이 있다.
# 메시지 무결성
- 메시지 무결성을 달성하려면 송수신자간 **인증 키**를 공유해야 한다.
- 원본 메시지와 인증 키를 합친 값을 가지고 해쉬를 취한 값을 **메시지 인증 코드(MAC; Massage Authentication Code)** 라고 부른다.
- MAC는 암호화 알고리즘 없이도 구현 가능하며, 대표적인 표준으로 HMAC이 있다.

1. 송신자는 메시지 $m$을 생성하고, 인증 키 $s$를 $m$과 합쳐 $m + s$를 생성한 뒤 MAC인 해시 $H(m + s)$를 계산한다. 
2. 송신자는 MAC를 메시지 $m$에 덧붙여 확장된 메시지 $(m, H(m + s))$를 만들고 수신자에게 보낸다.
3. 수신자는 확장된 메시지 $(m, h)$를 받고, $s$를 알고 있으므로 MAC $H(m + s)$를 계산한다. 만약 $H(m + s) = h$이면 수신자는 정상으로 판단한다.
# 디지털 서명
- 서명은 검증 가능해야 하며 위조될 수 없어야 한다.
- MAC은 인증 키를 공유해야 하므로 서명에 사용될 수 없다.
- 공개키 암호화로 디지털 서명과 메시지 무경성을 모두 수행할 수 있다.

1. 송신자가 개인 키 $K_B^-$를 사용하여 $K_B^-(m)$을 계산하여 문서 $m$에 서명한다.
2. 수신자는 공개 키 $K_B^+$를 가져와서 $K_B^+(K_B^-(m))$을 계산하여 $m$을 구한다.
3. 수신자는 원본 $m$과 일치함을 확인한다.

- 원본 메시지 $m$ 대신 $H(m)$에 서명하여 암호화/복호화 오버헤드를 줄일 수 있다.
![[digital_signature_sender.png]]
![[digital_signature_receiver.png]]
## 공개 키 인증
- 공개 키와 소유자의 신원을 연결하기 위해 **인증 기관(CA)이 발행한 인증서**가 사용되며, 이를 통해 공개 키의 위변조를 방지한다.
- 공개 키 인증은 IPsec, TLS 등에서 사용된다.