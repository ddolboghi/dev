# ref
---
- ì»´í¬ë„ŒíŠ¸ ì•ˆì—ì„œ ì¡°íšŒ ë° ìˆ˜ì •í•  ìˆ˜ ìˆëŠ” ë³€ìˆ˜ê°€  ìˆì§€ë§Œ í•´ë‹¹ ì •ë³´ë¡œ ì¸í•´ ìƒˆë¡œìš´ ë Œë”ë§ì„ ë°œìƒì‹œí‚¤ê³  ì‹¶ì§€ëŠ” ì•Šì„ë•Œ(`setTimeout`, `setInterval`ì„ í†µí•´ì„œ ë§Œë“¤ì–´ì§„ id, ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒì„±ëœ ì¸ìŠ¤í„´ìŠ¤)
- íŠ¹ì • DOMì„ ì„ íƒí•´ì•¼ í• ë•Œ(scrollì˜ ìœ„ì¹˜ ë“±)
- JSXë¥¼ ê³„ì‚°í•˜ëŠ”ë° í•„ìš”í•˜ì§€ ì•Šì€ ë‹¤ë¥¸ ê°ì²´ë¥¼ ì €ì¥í• ë•Œ
- í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ì—ì„œ `useRef()`ë¥¼ ì‚¬ìš©í•˜ì—¬ ref ì„¤ì •
- `ref.current`: ref ì†ì„±ì˜ í˜„ì¬ ê°’
- refëŠ” ëª¨ë“  ìœ í˜•ì˜ ê°’ì„ **ì°¸ì¡°**í•  ìˆ˜ ìˆëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ **ê°ì²´**ì„
- ë°ì´í„°ê°€ ì´ë²¤íŠ¸ ì²˜ë¦¬ë¶€ë¶„ì—ì„œë§Œ í•„ìš”í•˜ë©° ë³€ê²½ë˜ì–´ë„ ì¬ë Œë”ë§ì´ í•„ìš”í•˜ì§€ ì•Šì€ ê²½ìš°ì—ëŠ” refë¥¼ ì‚¬ìš©í•˜ëŠ”ê²Œ íš¨ìœ¨ì ì¼ ìˆ˜ ìˆìŒ
- refëŠ” ê°ì²´ì§€í–¥í”„ë¡œê·¸ë˜ë°ì—ì„œ ì¸ìŠ¤í„´ìŠ¤ í•„ë“œì™€ ë¹„ìŠ·í•˜ê²Œ ìƒê°í•˜ë©´ ë¨
  `this.something`ëŒ€ì‹  `somethingRef.current`ë¡œ ì‘ì„±í•¨
- ë¦¬ì•¡íŠ¸ëŠ” ì»¤ë°‹ ì¤‘ì— `ref.current`ë¥¼ ì„¤ì •í•¨
- ë³´í†µ refëŠ” ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ë¡œì§ ë‚´ë¶€ì—ì„œ ì ‘ê·¼í•´ DOM ìš”ì†Œë¥¼ ì œì–´í•¨
([ë§¨ ë°‘ì˜ ë¬¸ì œ í’€ê¸°](https://react.dev/learn/referencing-values-with-refs))
```jsx
import { useRef } from 'react'; //useRef í›… ì„í¬íŠ¸

export default function myComponent() {
	const ref = useRef(0); // useRef(ì´ˆê¸°ê°’)
}
```

| ref                                                            | state                                                                            |
| -------------------------------------------------------------- | -------------------------------------------------------------------------------- |
| `useRef(ì´ˆê¸°ê°’)`ëŠ” `{current: ì´ˆê¸°ê°’}`ë°˜í™˜                     | `useState(ì´ˆê¸°ê°’)`ì€ ìƒíƒœ ë³€ìˆ˜ì˜ í˜„ì¬ê°’ê³¼ ìƒíƒœ ì„¤ì •í•¨ìˆ˜(`[value, setValue]`)ë°˜í™˜ |
| ë³€ê²½ì‹œ ì¬ë Œë”ë§ì„ íŠ¸ë¦¬ê±°í•˜ì§€ ì•ŠìŒ                                | ë³€ê²½ì‹œ ì¬ë Œë”ë§ì„ íŠ¸ë¦¬ê±°í•¨                                                         |
| **ê°€ë³€** --> ë Œë”ë§ í”„ë¡œì„¸ìŠ¤ ì™¸ë¶€ì—ì„œ `current`ì˜ ê°’ ìˆ˜ì • ê°€ëŠ¥ | **ë¶ˆë³€** --> ìƒíƒœë³€ìˆ˜ë¥¼ ìˆ˜ì •í•˜ë ¤ë©´ setterë¥¼ ì‚¬ìš©í•´ì•¼í•˜ê³ , ì¬ë Œë”ë§ì„ ì˜ˆì•½í•´ì•¼í•¨  |
| ë Œë”ë§ ì¤‘ì—ëŠ” `current`ê°’ì„ ì½ê±°ë‚˜ ì“°ì§€ ë§ì•„ì•¼í•¨               | ì–¸ì œë“ ì§€ ìƒíƒœ ê°’ì„ ì½ì„ ìˆ˜ ìˆì§€ë§Œ ê° ë Œë”ë§ì—ëŠ” ìƒíƒœì˜ ìŠ¤ëƒ…ìƒ·ì´ ìˆê³ , ë³€ê²½ë˜ì§€ ì•ŠìŒ                                                                                 |

## ref ì‚¬ìš© ì‹œ ì£¼ì˜ì‚¬í•­
---
- refë¥¼ íƒˆì¶œêµ¬ë¡œ ì·¨ê¸‰í•˜ê¸°: ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œì§ê³¼ ë°ì´í„° íë¦„ì˜ ëŒ€ë¶€ë¶„ì´ refì— ì˜ì¡´í•˜ì§€ ì•Šë„ë¡í•˜ê¸°
- ë Œë”ë§ ì¤‘ì— `ref.current`ë¥¼ ì½ê±°ë‚˜ ì“°ê¸° ë§ê¸°: ë¦¬ì•¡íŠ¸ëŠ” `ref.current`ê°€ ì–¸ì œ ë³€ê²½ë˜ëŠ”ì§€ ëª¨ë¥´ê¸° ë•Œë¬¸ì— ë Œë”ë§ ì¤‘ì— ì½ëŠ” ê²ƒë§Œìœ¼ë¡œë„ ì»´í¬ë„ŒíŠ¸ì˜ ë™ì‘ì„ ì˜ˆì¸¡í•˜ê¸° ì–´ë µê²Œ ë§Œë“¬
  ë Œë”ë§ ì¤‘ì— í•„ìš”í•œ ì •ë³´ê°€ ìˆìœ¼ë©´ state ì‚¬ìš©í•˜ê¸°
  ë‹¨, `ref.current = new Thing()`ì²˜ëŸ¼ ì²« ë²ˆì§¸ ë Œë”ë§ ì¤‘ì— refë¥¼ í•œë²ˆë§Œ ì„¤ì •í•˜ëŠ” ê²½ìš°ëŠ” ì˜ˆì™¸
- ë¦¬ì•¡íŠ¸ê°€ ê´€ë¦¬í•˜ëŠ”(stateìœ¼ë¡œ ë Œë”ë§ë˜ëŠ” ë“±) DOM ë…¸ë“œë¥¼ ë³€ê²½í•˜ì§€ ë§ê¸°(refë¡œ DOMì„ ì§ì ‘ ìˆ˜ì •í•˜ê±°ë‚˜ ìì‹ ìš”ì†Œë¥¼ ì¶”ê°€ ë˜ëŠ” ì œê±°í•˜ë©´ ì¶©ëŒí•  ìˆ˜ ìˆìŒ)
- ë¦¬ì•¡íŠ¸ê°€ ê´€ë¦¬í•˜ëŠ” DOM ë…¸ë“œì—ì„œ ì—…ë°ì´íŠ¸í•˜ì§€ ì•ŠëŠ” ë¶€ë¶„ë§Œ refë¡œ ìˆ˜ì •í•˜ë©´ ì•ˆì „í•¨
## refë¥¼ ì‚¬ìš©í•œ DOM ì¡°ì‘
---
- DOM ìš”ì†Œì— ì´ˆì ì„ ë§ì¶”ê±°ë‚˜, ìŠ¤í¬ë¡¤í•˜ê±°ë‚˜, í¬ê¸°ì™€ ìœ„ì¹˜ë¥¼ ì¸¡ì •í•´ì•¼ í• ë•Œ
- JSX ìš”ì†Œì˜ `ref`ì†ì„±ì— `useRef`ë¡œ ì„¤ì •í•œ ref ê°ì²´ë¥¼ ì „ë‹¬í•˜ë©´ ë¦¬ì•¡íŠ¸ê°€ í•´ë‹¹í•˜ëŠ” DOM ìš”ì†Œë¥¼ `myRef.current`ì— ë„£ì–´ ë‚´ì¥ ë¸Œë¼ìš°ì € APIë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ([refë¥¼ ì‚¬ìš©í•œ DOM ì¡°ì‘ ë¬¸ì œ í’€ê¸°](https://react.dev/learn/manipulating-the-dom-with-refs))
```jsx
import { useRef } from 'react';

export default function Form() {
	const inputRef = useRef(null);

	const handleClick = () => {
		inputRef.current.focus(); //ë‚´ì¥ ë¸Œë¼ìš°ì € APIì¸ focus() ì‚¬ìš©
	};

	return (
		<>
			<input ref={inputRef} />
			<button onClick={handleClick}>Focus the input</button>
		</>
	);
}
```
### ref ì½œë°±
---
- `ref`ì½œë°±ì€ JSX ìš”ì†Œì˜ `ref` ì†ì„±ì—ì„œ ì½œë°± í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒ
- `ref`ì½œë°±ìœ¼ë¡œ ref ëª©ë¡ì„ ê´€ë¦¬í•  ìˆ˜ ìˆìŒ
- ë¦¬ì•¡íŠ¸ëŠ” ref ì½œë°± í˜¸ì¶œì‹œ refë¥¼ ì„¤ì •í•  DOM ë…¸ë“œë„ í•¨ê»˜ í˜¸ì¶œ
- ì½œë°± í•¨ìˆ˜ì—ì„œ ë…¸ë“œ ì‚­ì œì‹œ null ì „ë‹¬í•¨
```jsx
import { useRef } from 'react';
  
export default function CatFriends() {
Â  const itemsRef = useRef(null); // refëŠ” ë¦¬ìŠ¤íŠ¸ì˜ ì•„ì´í…œë“¤ì„ ê°€ì§„ ë§µ ê°ì²´

Â  function scrollToId(itemId) {
Â  Â  const map = getMap();
Â  Â  const node = map.get(itemId);
Â  Â  node.scrollIntoView({
Â  Â  Â  behavior: 'smooth',
Â  Â  Â  block: 'nearest',
Â  Â  Â  inline: 'center'
Â  Â  });
Â  }
  
Â  function getMap() {
Â  Â  if (!itemsRef.current) {
Â  Â  Â  // Initialize the Map on first usage.
Â  Â  Â  itemsRef.current = new Map();
Â  Â  }
Â  Â  return itemsRef.current;
Â  }
  
Â  return (
Â  Â  <>
Â  Â  Â  <nav>
Â  Â  Â  Â  <button onClick={() => scrollToId(0)}>
Â  Â  Â  Â  Â  Tom
Â  Â  Â  Â  </button>
Â  Â  Â  Â  <button onClick={() => scrollToId(5)}>
Â  Â  Â  Â  Â  Maru
Â  Â  Â  Â  </button>
Â  Â  Â  Â  <button onClick={() => scrollToId(9)}>
Â  Â  Â  Â  Â  Jellylorum
Â  Â  Â  Â  </button>
Â  Â  Â  </nav>
Â  Â  Â  <div>
Â  Â  Â  Â  <ul>
Â  Â  Â  Â  Â  {catList.map(cat => ( //mapë©”ì„œë“œë¡œ ë¦¬ìŠ¤íŠ¸ì˜ ëª¨ë“  ì•„ì´í…œ ìˆœíšŒ
Â  Â  Â  Â  Â  Â  <li
Â  Â  Â  Â  Â  Â  Â  key={cat.id}
Â  Â  Â  Â  Â  Â  Â  ref={(node) => {
Â  Â  Â  Â  Â  Â  Â  Â  const map = getMap(); //í˜„ì¬ ref ê°’ì¸ ë§µì„ ê°€ì ¸ì˜´
Â  Â  Â  Â  Â  Â  Â  Â  if (node) { //ë…¸ë“œê°€ ìˆë‹¤ë©´ ë§µì— í•´ë‹¹ ì•„ì´í…œ ì¶”ê°€
Â  Â  Â  Â  Â  Â  Â  Â  Â  map.set(cat.id, node);
Â  Â  Â  Â  Â  Â  Â  Â  } else { //ë…¸ë“œê°€ ì—†ë‹¤ë©´ ë§µì—ì„œ í•´ë‹¹ ì•„ì´í…œ ì‚­ì œ
Â  Â  Â  Â  Â  Â  Â  Â  Â  map.delete(cat.id); 
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  }}
Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  <img
Â  Â  Â  Â  Â  Â  Â  Â  src={cat.imageUrl}
Â  Â  Â  Â  Â  Â  Â  Â  alt={'Cat #' + cat.id}
Â  Â  Â  Â  Â  Â  Â  />
Â  Â  Â  Â  Â  Â  </li>
Â  Â  Â  Â  Â  ))}
Â  Â  Â  Â  </ul>
Â  Â  Â  </div>
Â  Â  </>
Â  );
}
  
const catList = [];
for (let i = 0; i < 10; i++) {
Â  catList.push({
Â  Â  id: i,
Â  Â  imageUrl: 'https://placekitten.com/250/200?image=' + i
Â  });
}
```

### ì»´í¬ë„ŒíŠ¸ì—ì„œ ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ì˜ DOMì— ì ‘ê·¼í•˜ê¸°
---
#### `forwardRef()`
- ë‚´ì¥ JSXê°€ ì•„ë‹Œ ì§ì ‘ ë§Œë“  JSXì— `ref={myRef}`ë¥¼ ë„£ìœ¼ë©´ ë™ì‘í•˜ì§€ ì•Šê³  null ì „ë‹¬í•¨ --> ì»´í¬ë„ŒíŠ¸ê°€ ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ì˜ DOM ë…¸ë“œì— ì ‘ê·¼í•  ìˆ˜ ì—†ê²Œ ë§‰ê¸° ìœ„í•´ ë°œìƒí•˜ëŠ” ê²ƒ
- refë¥¼ ë°›ëŠ” ì»´í¬ë„ŒíŠ¸ì—ì„œ `forwardRef()`ë¥¼ ì‚¬ìš©í•´ refë¥¼ ë°›ì•„ ìì‹ ì˜ íŠ¹ì •í•œ JSX ìš”ì†Œì— ë„£ì„ ìˆ˜ ìˆìŒ
- ë²„íŠ¼, ì…ë ¥ë€ì„ ê°€ì§„ í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ê°€ DOM ë…¸ë“œë¡œ refë¥¼ ì „ë‹¬í•˜ê³  í¼, ëª©ë¡, í˜ì´ì§€ ì„¹ì…˜ ê°™ì€ ìƒìœ„ ì»´í¬ë„ŒíŠ¸ëŠ” DOM ë…¸ë“œë¥¼ ë…¸ì¶œí•˜ì§€(ì§ì ‘ ì‚¬ìš©í•˜ì§€) ì•Šê³  DOM êµ¬ì¡°ì— ì˜ì¡´ì„±ì„ ê°–ì§€ ì•Šë„ë¡ í•´ì•¼í•¨
```jsx
import { forwardRef, useRef } from 'react';

const MyInput = forwardRef((props, ref) => {
	return <input {...props} ref={ref} />;
});

export default function Form() {
	const inputRef = useRef(null);
	const handleClick = () => {
		inputRef.current.focus();
	};
	return (
		<>
			<MyInput ref={inputRef} />
			<button onClick={handleClick}>Focus the input</button>
		</>
	);
}
```
#### `useImperativeHandle()`
- í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ê°€ ìƒìœ„ ì»´í¬ë„ŒíŠ¸ì— ë…¸ì¶œë˜ëŠ” ê¸°ëŠ¥ì„ ì œí•œì‹œí‚´
- ìƒìœ„ ì»´í¬ë„ŒíŠ¸ëŠ” í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ì˜ DOM ë…¸ë“œê°€ ì•„ë‹Œ `useImperativeHandle`í˜¸ì¶œ ë‚´ì—ì„œ ìƒì„±í•œ ì‚¬ìš©ì ì§€ì • ê°ì²´ë¡œ ì ‘ê·¼í•˜ê²Œ ë¨
```jsx
import { forwardRef, useRef, useImperativeHandle } from 'react';

const MyInput = forwardRef((props, ref) => {
	const realInputRef = useRef(null);
	useImperativeHandle(ref, () => ({
		focus () {
			realInputRef.current.focus();
		},
	}));
	return <input {...props} ref={realInputRef} />;
});

export default function Form() {
	const inputRef = useRef(null);

	function handleClick() {
		inputRef.current.focus();
	}
	return (
		<>
			<MyInput ref={inputRef} />
			<button onClick={handleClick}>Focus the input</button>
		</>
	);
}
```
### `flushSync`ë¡œ ë™ê¸°ì ìœ¼ë¡œ DOM ì—…ë°ì´íŠ¸í•˜ê¸°
---
- ìƒíƒœ setterê°€ DOMì„ ì¦‰ì‹œ ì—…ë°ì´íŠ¸í•˜ì§€ ì•Šì•„ ë¬¸ì œë  ê²½ìš° ì‚¬ìš©
```jsx
export default function TodoList() {
Â  const listRef = useRef(null);
Â  const [text, setText] = useState('');
Â  const [todos, setTodos] = useState(
Â  Â  initialTodos
Â  );
  
Â  function handleAdd() {
Â  Â  const newTodo = { id: nextId++, text: text };
Â  Â  setText('');
Â  Â  setTodos([ ...todos, newTodo]); //ì•„ë˜ì˜ refë¥¼ ìˆ˜í–‰í•œ í›„ì— newTodoê°€ ì¶”ê°€
Â  Â  listRef.current.lastChild.scrollIntoView({ //ì—…ë°ì´íŠ¸ë˜ê¸° ì „ì˜ todosë¥¼ ì‚¬ìš©í•˜ê²Œ ë¨
Â  Â  Â  behavior: 'smooth',
Â  Â  Â  block: 'nearest'
Â  Â  });
Â  }
...
}
```

1. react-domì—ì„œ flushSync ì„í¬íŠ¸
```jsx
import { flushSync } from 'react-dom';
```
2. ìƒíƒœ ì—…ë°ì´íŠ¸ ë¶€ë¶„ì„ flushSyncë¡œ ë‘˜ëŸ¬ì‹¸ê¸°
```jsx
flushSync(() => {
	setTodos([ ...todos, newTodo]);
});
```

# `useEffect`
---
- EffectëŠ” ë¦¬ì•¡íŠ¸ ì½”ë“œì—ì„œ íƒˆì¶œí•˜ì—¬ ì™¸ë¶€ ì‹œìŠ¤í…œê³¼ ë™ê¸°í™”í•˜ëŠ”ë° ì‚¬ìš©ë¨
- EffectëŠ” íŠ¹ì • ì´ë²¤íŠ¸ê°€ ì•„ë‹Œ ë Œë”ë§ ìì²´ì— ì˜í•´ ë°œìƒí•˜ëŠ” ì‚¬ì´ë“œì´í™íŠ¸ ì§€ì •í•  ìˆ˜ ìˆìŒ --> ì‚¬ì´ë“œì´í™íŠ¸ë¥¼ ë Œë”ë§ ê³„ì‚°ì—ì„œ ë¶„ë¦¬í•˜ê¸°ìœ„í•´ `useEffect`ë¡œ ì‚¬ì´ë“œì´í™íŠ¸ë¥¼ ë˜í•‘í•¨
- EffectëŠ” í™”ë©´ì´ ì—…ë°ì´íŠ¸ëœ í›„ì— ì»¤ë°‹ì´ ëë‚˜ëŠ” ì‹œì ì— ì‹¤í–‰ë˜ê³ , ì´ ì‹œì ì—ì„œ ì»´í¬ë„ŒíŠ¸ë¥¼ ì™¸ë¶€ ì‹œìŠ¤í…œê³¼ ë™ê¸°í™”í•˜ëŠ” ê²Œ ì¢‹ìŒ
- ì‚¬ì´ë“œì´í™íŠ¸ê°€ ë‹¤ë¥¸ ìƒíƒœì— ê¸°ë°˜í•˜ì—¬ ì–´ë–¤ ìƒíƒœë¥¼ ì¡°ì •í•˜ëŠ” ê²½ìš°ì—ëŠ” Effectê°€ í•„ìš”í•˜ì§€ ì•Šì„ ìˆ˜ë„ ìˆìŒ
- ì»´í¬ë„ŒíŠ¸ê°€ ë Œë”ë§ë ë•Œë§ˆë‹¤ ì‹¤í–‰ë˜ëŠ” EffectëŠ” ëª¨ë‘ ë…ë¦½ì ì„
- **ë Œë”ë§ ì¤‘ DOMì„ ìˆ˜ì •í•˜ëŠ” í–‰ìœ„ë„ ì‚¬ì´ë“œì´í™íŠ¸ì„**
- ê°œë°œ ì¤‘ì—ë§Œ ë°œìƒí•˜ëŠ” ë™ì‘: Strict Modeê°€ í™œì„±í™”ë˜ìˆìœ¼ë©´ ë¦¬ì•¡íŠ¸ëŠ” ê° ì»´í¬ë„ŒíŠ¸ë¥¼ ë§ˆìš´íŠ¸í•œ í›„ í•œ ë²ˆ ë” ë¦¬ë§ˆìš´íŠ¸í•¨(ìƒíƒœì™€ DOMì€ ë³´ì¡´ë¨) --> clean-upì´ í•„ìš”í•œ Effectë¥¼ ì°¾ëŠ”ë° ë„ì›€ë˜ë©°, ì´ˆê¸°ì— ë²„ê·¸ ë°œê²¬ ê°€ëŠ¥

## 1. Effect ì„ ì–¸í•˜ê¸°
---
```jsx
import { useEffect } from 'react';

function MyComponent() {
	useEffect(() => {
	 // ì‚¬ì´ë“œì´í™íŠ¸ë¥¼ ìˆ˜í–‰í•˜ëŠ” ì½”ë“œ
	 // ì´ê³³ì˜ ì½”ë“œëŠ” ëª¨ë“  ë Œë”ë§ ì´í›„ì— ì‹¤í–‰ë¨
	}, [/* ì˜ì¡´ì„± ë°°ì—´ */]);
}
```
- ì»´í¬ë„ŒíŠ¸ê°€ ë Œë”ë§ë ë•Œë§ˆë‹¤ ë¦¬ì•¡íŠ¸ëŠ” í™”ë©´ì„ ì—…ë°ì´íŠ¸í•œ í›„ `useEffect`ë‚´ì˜ ì½”ë“œë¥¼ ì‹¤í–‰í•¨
```jsx
const [count, setCount] = useState(0);
useEffect(() => {
	setCount(count + 1);
});
```
- `useEffect`ë‚´ì—ì„œ ìƒíƒœë¥¼ ì¦‰ì‹œ ì„¤ì •í•˜ë©´ ë‹¤ì‹œ ë Œë”ë§ì´ ë°œìƒí•˜ê³ , ì´ë¡œì¸í•´ íš¨ê³¼ê°€ ë‹¤ì‹œ ì‹¤í–‰ë˜ê³  ë‹¤ì‹œ ìƒíƒœë¥¼ ì„¤ì •í•´ ë˜ ë‹¤ë¥¸ ë Œë”ë§ì´ ë°œìƒí•˜ë©° ë¬´í•œ ë£¨í”„ì— ë¹ ì§

## 2. Effectì˜ ì¢…ì†ì„± ì§€ì •í•˜ê¸°
---
- ë¦¬ì•¡íŠ¸ì—ê²Œ Effectë¥¼ ë¶ˆí•„ìš”í•˜ê²Œ ë‹¤ì‹œ ì‹¤í–‰í•˜ì§€ ë§ë¼ê³  ì§€ì‹œí•˜ë ¤ë©´ `useEffect`ì˜ ë‘ë²ˆì§¸ ì¸ìë¡œ ì¢…ì†ì„± ë°°ì—´ì„ ì§€ì •í•˜ë©´ ë¨
- `useEffect`ë‚´ë¶€ì˜ ì½”ë“œê°€ ì˜ì¡´í•˜ëŠ” ê°’ì„ ì¢…ì†ì„± ë°°ì—´ì— ì¶”ê°€í•´ì•¼í•¨
	- Effectì—ì„œ ì½ì€ ëª¨ë“  ë°˜ì‘í˜• ê°’(props, state, ê·¸ì™¸ ì»´í¬ë„ŒíŠ¸ ë‚´ì—ì„œ ì‚¬ìš©ë˜ëŠ” ê°’)ì´ë©´ì„œ ì»´í¬ë„ŒíŠ¸ë¥¼ ì¬ë Œë”ë§í•˜ê±°ë‚˜ useEffectë¥¼ ì¬ì‹¤í–‰í•˜ëŠ”ë° ì˜í–¥ì„ ì£¼ëŠ” ê°’ë§Œ ì¶”ê°€í•´ì•¼í•¨
- **ì§€ì •í•œ ëª¨ë“  ì¢…ì†ì„±ì´ ì´ì „ ë Œë”ë§ê³¼ ì •í™•íˆ ë™ì¼í•œ ê°’ì„ ê°–ëŠ” ê²½ìš°ì—ë§Œ Effectë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•˜ì§€ ì•ŠìŒ**
```jsx
 useEffect(() => {
	if (isPlaying) { // ì—¬ê¸°ì„œ ì‚¬ìš©ë©ë‹ˆë‹¤...
	  // ...
	} else {
	  // ...
	}
}, [isPlaying]); // ...ë”°ë¼ì„œ ì—¬ê¸°ì„œ ì„ ì–¸ë˜ì–´ì•¼ í•©ë‹ˆë‹¤!
```

- ì¢…ì†ì„± ë°°ì—´ì´ ì•„ì˜ˆ ì—†ìœ¼ë©´ `useEffect`ëŠ” ëª¨ë“  ë Œë”ë§ ì´í›„ì— ì‹¤í–‰ë˜ë©°, ë Œë”ë§ë ë•Œë§ˆë‹¤ ì‹¤í–‰ë¨
```jsx
useEffect(() => {
	...
});
```
- ë¹ˆ ì¢…ì†ì„± ë°°ì—´ì´ ìˆìœ¼ë©´ ì»´í¬ë„ŒíŠ¸ê°€ ì²˜ìŒ ë‚˜íƒ€ë‚ ë•Œ(ë§ˆìš´íŠ¸ë ë•Œ)ë§Œ ì‹¤í–‰ë˜ì§€ë§Œ, ì»´í¬ë„ŒíŠ¸ê°€ ìƒˆë¡œ ë Œë”ë§ë˜ë©´ ë‹¤ì‹œ ì‹¤í–‰ë¨
```jsx
useEffect(() => {
  ...
}, []);
```
- ì¢…ì†ì„± ë°°ì—´ì— ê°’ì´ ìˆìœ¼ë©´ ë§ˆìš´íŠ¸ë ë•Œë„ ì‹¤í–‰ë˜ê³ , ë§ˆì§€ë§‰ ë Œë”ë§ ì´í›„ì— ê°’ì´ ë³€ê²½ëœ ê²½ìš°ì—ë„ ì‹¤í–‰ë¨
```jsx
useEffect(() => {
  // ì´ê²ƒì€ ë§ˆìš´íŠ¸ë  ë•Œ ì‹¤í–‰ë˜ë©°, a ë˜ëŠ” bê°€ ë§ˆì§€ë§‰ ë Œë”ë§ ì´í›„ì— ë³€ê²½ëœ ê²½ìš°ì—ë„ ì‹¤í–‰ë©ë‹ˆë‹¤.
}, [a, b]);
```

### ì¢…ì†ì„± ë°°ì—´ì—ì„œ ìƒëµë  ìˆ˜ ìˆëŠ” ê²ƒë“¤
---
- ì•ˆì •ì ì¸ ì‹ë³„ì„±ì„ ê°–ëŠ” ê°’, í•­ìƒ ë™ì¼í•œ ê°’ì€ `useEffect`ë¥¼ ë‹¤ì‹œ ì‹¤í–‰ì‹œí‚¤ì§€ ì•Šê¸° ë•Œë¬¸ì— ìƒëµ ê°€ëŠ¥
- ë‹¨, ë¦°í„°ê°€ í•´ë‹¹ ê°’ì´ ì•ˆì •ì ì¸ì§€ ë³´ê³  ìˆì„ë•Œë§Œ ìƒëµê°€ëŠ¥
  ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì „ë‹¬ë˜ëŠ” ê°’ì€ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì¢…ì†ì„± ë°°ì—´ì— ì¶”ê°€í•´ì•¼í•¨

### ì¢…ì†ì„±ìœ¼ë¡œ ì¸í•´ ì›í•˜ì§€ ì•ŠëŠ” Effectê°€ ë™ì‘í• ë•Œ
---
- Effectê°€ ë…ë¦½ì ì¸ ë™ê¸°í™” í”„ë¡œì„¸ìŠ¤ë¥¼ ë‚˜íƒ€ë‚´ëŠ”ì§€ í™•ì¸í•˜ê¸°
	- Effectê°€ ì•„ë¬´ê²ƒë„ ë™ê¸°í™”í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ ë¶ˆí•„ìš”í•œ ë™ê¸°í™”ì¼ ìˆ˜ ìˆìŒ
	- ì—¬ëŸ¬ ê°œì˜ ë…ë¦½ì ì¸ ê²ƒì„ ë™ê¸°í™”í•˜ëŠ” ê²½ìš° ì´ë¥¼ ë¶„í• í•˜ê¸°
- propsë‚˜ stateì— ë°˜ì‘í•˜ì§€ ì•Šìœ¼ë©° Effectë¥¼ ë‹¤ì‹œ ë™ê¸°í™”í•˜ì§€ ì•Šê³  ìµœì‹  ê°’ì„ ì½ìœ¼ë ¤ë©´ Effectë¥¼ ë°˜ì‘í•˜ëŠ” ë¶€ë¶„ì™€ ë°˜ì‘í•˜ì§€ ì•ŠëŠ” ë¶€ë¶„(Effect Event)ìœ¼ë¡œ ë¶„í• í•˜ê¸°([ì°¸ê³ : ì´ë²¤íŠ¸ ë¶„í• í•˜ê¸°](https://react.dev/learn/separating-events-from-effects))
- ê°ì²´ì™€ í•¨ìˆ˜ë¥¼ ì¢…ì†ì„±ìœ¼ë¡œ ì˜ì¡´í•˜ì§€ ë§ê¸°([ì°¸ê³ : ë¶ˆí•„ìš”í•œ ì˜ì¡´ì„± ì œê±°](https://react.dev/learn/removing-effect-dependencies))
	- ë Œë”ë§ ì¤‘ì— ê°ì²´ì™€ í•¨ìˆ˜ë¥¼ ìƒì„±í•˜ê³  `useEffect`ì—ì„œ ì½ìœ¼ë©´ ë Œë”ë§í• ë•Œë§ˆë‹¤ ê°ì²´ì™€ í•¨ìˆ˜ê°€ ë‹¬ë¼ì ¸ Effectê°€ ë§¤ë²ˆ ë‹¤ì‹œ ë™ê¸°í™”ë¨

## 3. (í•„ìš”í•œ ê²½ìš°) clean-upí•¨ìˆ˜ ì¶”ê°€í•˜ê¸°
---
- EffectëŠ” ë‚´ë¶€ì—ì„œ ì‚¬ìš©í•˜ëŠ” ì¢…ì†ì ì¸ ê°’ì´ ë³€í•˜ê±°ë‚˜ ì»´í¬ë„ŒíŠ¸ê°€ ì¬ë Œë”ë§ë˜ë©´ `useEffect`ê°€ ë‹¤ì‹œ ì‹¤í–‰ë˜ê¸° ë•Œë¬¸ì— ë¶ˆí•„ìš”í•œ ë™ì‘ì´ ìœ ì§€ë  ìˆ˜ ìˆìŒ
- clean-upí•¨ìˆ˜ëŠ” `useEffect`ê°€ ìˆ˜í–‰í•œ ì‘ì—…ì„ ì¤‘ë‹¨í•˜ê±°ë‚˜ ë˜ëŒë¦¼
- clean-upí•¨ìˆ˜ë¥¼ ì¶”ê°€í•˜ë©´ Effectê°€ ë‹¤ì‹œ ì‹¤í–‰ë˜ê¸° ì „ì— ë§¤ë²ˆ clean-upí•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©°, ì»´í¬ë„ŒíŠ¸ê°€ ì œê±°(ì–¸ë§ˆìš´íŠ¸)ë ë•Œë„ í˜¸ì¶œí•¨
- ë¦¬ì•¡íŠ¸ëŠ” ì´ì „ ë Œë”ì˜ Effectë¥¼ í•­ìƒ ë‹¤ìŒ ë Œë”ì˜ Effectë³´ë‹¤ ë¨¼ì € ì •ë¦¬í•¨
- ì‚¬ìš©ìê°€ `useEffect` í•œë²ˆ ì‹¤í–‰í•˜ëŠ” ê²ƒ(í”„ë¡œë•ì…˜ í™˜ê²½)ê³¼ 'ì„¤ì • --> ì •ë¦¬ --> ì„¤ì •'(ê°œë°œ í™˜ê²½)ì„ êµ¬ë¶„í•  ìˆ˜ ì—†ì–´ì•¼í•¨

### ë¹„ ë¦¬ì•¡íŠ¸ ìœ„ì ¯ ì œì–´í•˜ê¸°
---
- ë¦¬ì•¡íŠ¸ë¡œ ì‘ì„±ë˜ì§€ ì•Šì€ UI ìœ„ì ¯ì´ ë§ˆìš´íŠ¸ë˜ë©° ë¶ˆí•„ìš”í•œ ë™ì‘ì„ ìœ ì§€í•˜ë©´ clean-upí•¨ìˆ˜ ì‘ì„±í•˜ê¸°
- ì—°ì†ìœ¼ë¡œ ë‘ ë²ˆ í˜¸ì¶œí•˜ë©´ ì˜ˆì™¸ê°€ ë°œìƒí•˜ëŠ” ì¼ë¶€ APIë“¤ì„ ì‚¬ìš©í• ë•Œ clean-upí•¨ìˆ˜ ì‘ì„±í•˜ê¸°(e.g. `<dialog>`ì˜ `showModal()`ë©”ì„œë“œ)
```jsx
useEffect(() => {
	const dialog = dialogRef.current;
	dialog.showModal();
	return () => dialog.close();
}, []);
```

### ì´ë²¤íŠ¸ êµ¬ë… í•´ì§€í•˜ê¸°
---
- Effectê°€ `addEventListener()` ê°™ì€ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¥¼ í˜¸ì¶œí•˜ê³  ìˆë‹¤ë©´ clean-upí•¨ìˆ˜ì— `removeEventListener()`ë“±ì„ ì‚¬ìš©í•´ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¥¼ ì œê±°í•´ì•¼í•¨
```jsx
React.useEffect(() => {
Â  Â  const handleResize = () => {
Â  Â  Â  if (window.innerWidth > 833) {
Â  Â  Â  Â  setActive('nav-menu');
Â  Â  Â  Â  setToggler('nav-toggler');
Â  Â  Â  }
Â  Â  };
Â  Â  window.addEventListener('resize', handleResize);
Â  Â  return () => {
Â  Â  Â  window.removeEventListener('resize', handleResize);
Â  Â  };
Â  }, []);
```

### ì• ë‹ˆë©”ì´ì…˜ íŠ¸ë¦¬ê±°ì‹œ ì´ˆê¸°ê°’ìœ¼ë¡œ ì¬ì„¤ì •í•˜ê¸°
---
- Effectê°€ ì• ë‹ˆë©”ì´ì…˜ì„ íŠ¸ë¦¬ê±°í•œë‹¤ë©´ clean-upí•¨ìˆ˜ë¡œ ì• ë‹ˆë©”ì´ì…˜ì„ ì´ˆê¸°ê°’ìœ¼ë¡œ ì¬ì„¤ì •í•´ì•¼í•¨
```jsx
useEffect(() => {
	const node = ref.current;
	node.style.opacity = 1; // ì• ë‹ˆë©”ì´ì…˜ íŠ¸ë¦¬ê±°
	return () => {
		node.style.opacity = 0; // ì´ˆê¸° ê°’ìœ¼ë¡œ ì¬ì„¤ì •
	};
}, []);
```

### ì„œë²„ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¨ í›„ fetchë¥¼ ì¤‘ë‹¨í•˜ê±°ë‚˜ ê²°ê³¼ë¥¼ ë¬´ì‹œí•´ì•¼í•¨
---
```jsx
useEffect(() => {
	let ignore = false;
	async function startFetching() {
	const json = await fetchTodos(userId);
		if (!ignore) {
			setTodos(json);
		}
	}
	startFetching();
	return () => {
	ignore = true;
	};
}, [userId]);
```
- Effectê°€ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ë•Œ clean-upí•¨ìˆ˜ëŠ” ë” ì´ìƒ ê´€ë ¨ ì—†ëŠ” fetchê°€ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•Šë„ë¡ í•´ì•¼í•¨
- EffectëŠ” ì„œë²„ì—ì„œ ì‹¤í–‰ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ë Œë”ë§ì‹œ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ê³  ì•±ì„ ë Œë”ë§í•œ í›„ì—ì•¼ ë°ì´í„°ê°€ ë¡œë“œë¨
- Effect ë‚´ì—ì„œ ì§ì ‘ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ë©´ 'ë„¤íŠ¸ì›Œí¬ í­í¬'ê°€ ë°œìƒí•´ ëŠë ¤ì§ˆ ìˆ˜ ìˆìŒ
- Effect ë‚´ì—ì„œ ì§ì ‘ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ê²ƒì€ ë°ì´í„°ë¥¼ ì‚¬ì „ ë¡œë“œí•˜ì§€ ì•Šê±°ë‚˜ ìºì‹œí•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ì˜ë¯¸ì„
- í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš° ë‚´ì¥ëœ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ë©”ì»¤ë‹ˆì¦˜ ì‚¬ìš©í•˜ê¸°
- í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ í´ë¼ì´ì–¸íŠ¸ ì¸¡ ìºì‹œë¥¼ ì‚¬ìš©í•˜ê±°ë‚˜ êµ¬ì¶•í•˜ê¸°
	- ì˜¤í”ˆ ì†ŒìŠ¤ ì†”ë£¨ì…˜: React Query, useSWR, React Router 6.4+

### Effectë¡œ ì‹¤í–‰í•˜ë©´ ì•ˆë˜ëŠ” ê²½ìš°
---
- ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ˆê¸°í™”: ì¼ë¶€ ë¡œì§ì€ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹œì‘ë ë•Œ í•œ ë²ˆë§Œ ì‹¤í–‰ë˜ì•¼í•¨
```jsx
if (typeof window !== 'undefined') { // ë¸Œë¼ìš°ì €ì—ì„œ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸í•©ë‹ˆë‹¤.
	checkAuthToken();
	loadDataFromLocalStorage();
}

function App() {
	// ...
}
```
- ì œí’ˆ êµ¬ë§¤: Effectì—ì„œ ì œí’ˆ êµ¬ë§¤ POSTìš”ì²­ì„ ë³´ë‚´ë©´, ë‹¤ë¥¸ í˜ì´ì§€ë¡œ ì´ë™í•œ í›„ì— ë’¤ë¡œê°€ê¸° ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ Effectê°€ ë‹¤ì‹œ ì‹¤í–‰ë˜ì–´ ë‘ ë²ˆ êµ¬ë§¤í•˜ê²Œ ë¨
```jsx
useEffect(() => {
	// ğŸ”´ ì˜ëª»ëœ ì˜ˆ: ì´ íš¨ê³¼ëŠ” ê°œë°œ í™˜ê²½ì—ì„œ ë‘ ë²ˆ ì‹¤í–‰ë˜ì–´ ì½”ë“œì— ë¬¸ì œê°€ ë…¸ì¶œë©ë‹ˆë‹¤.
	fetch('/api/buy', { method: 'POST' });
}, []);

function handleClick() {
	// âœ… êµ¬ë§¤ëŠ” íŠ¹ì • ìƒí˜¸ ì‘ìš©ì— ì˜í•´ ë°œìƒí•˜ê¸° ë•Œë¬¸ì— ì´ë²¤íŠ¸ì…ë‹ˆë‹¤.
	fetch('/api/buy', { method: 'POST' });
}
```

## Effect ë™ì‘ ì´í•´í•˜ê¸°
---
```jsx
export default function ChatRoom({ roomId }) {
	useEffect(() => {
		const connection = createConnection(roomId);
		connection.connect();
		return () => connection.disconnect();
	}, [roomId]);
	return <h1>Welcome to {roomId}!</h1>;
}
```

1. ì´ˆê¸° ë Œë”ë§ë ë•Œ
- ì‚¬ìš©ìê°€ `<ChatRoom roomId="general" />`ì— ë°©ë¬¸í•˜ë©´ ì²«ë²ˆì§¸ ë Œë”ë§ì˜ JSXëŠ” ë‹¤ìŒê³¼ ê°™ìŒ
```jsx
return <h1>Welcome to general!</h1>;
```
- ë Œë”ë§í›„ `useEffect`ì‹¤í–‰
```jsx
// ì²« ë²ˆì§¸ ë Œë”ë§ì˜ íš¨ê³¼(Effect) (roomId = "general")
() => {
  const connection = createConnection('general');
  connection.connect();
  return () => connection.disconnect();
},
// ì²« ë²ˆì§¸ ë Œë”ë§ì˜ ì¢…ì†ì„±(dependencies) (roomId = "general")
['general']
```

2. ê°™ì€ ì¢…ì†ì„±(roomId)ìœ¼ë¡œ ì¬ë Œë”ë§ë ë•Œ
- `<ChatRoom roomId="general" />`ì´ ì¬ë Œë”ë§ë˜ë©´ JSX ì¶œë ¥ì€ ë™ì¼í•¨
- ì¬ë Œë”ë§ì‹œ ë¦¬ì•¡íŠ¸ëŠ” `useEffect`ì˜ ì´ì „ ì¢…ì†ì„±ê³¼ í˜„ì¬ ì¢…ì†ì„±ì„ ë¹„êµí•˜ê³  ëª¨ë“  ì¢…ì†ì„±ì´ ë™ì¼í•˜ë©´ `useEffect`ë¥¼ í˜¸ì¶œí•˜ì§€ ì•ŠìŒ(Effectë¥¼ ë¬´ì‹œí•¨)
```jsx
// ë‘ ë²ˆì§¸ ë Œë”ë§ì˜ JSX (roomId = "general")
return <h1>Welcome to general!</h1>;

// ë‘ ë²ˆì§¸ ë Œë”ë§ì˜ íš¨ê³¼(Effect) (roomId = "general")
() => {
  const connection = createConnection('general');
  connection.connect();
  return () => connection.disconnect();
},
// ë‘ ë²ˆì§¸ ë Œë”ë§ì˜ ì¢…ì†ì„±(dependencies) (roomId = "general")
['general']
```

3. ë‹¤ë¥¸ ì¢…ì†ì„±ìœ¼ë¡œ ì¬ë Œë”ë§ë ë•Œ
- ì‚¬ìš©ìê°€ `<ChatRoom roomId="travel" />`ë¥¼ ë°©ë¬¸í•˜ë©´ ì»´í¬ë„ŒíŠ¸ê°€ ë‹¤ë¥¸ JSXë¥¼ ë°˜í™˜í•¨
- ë¦¬ì•¡íŠ¸ëŠ” ì¬ë Œë”ë§ëœ Effectë¥¼ ì ìš©í•˜ê¸° ì „ì— ì‹¤í–‰ë˜ì—ˆë˜ ë§ˆì§€ë§‰ Effect(ì²«ë²ˆì§¸ ë Œë”ë§ì˜ Effect)ë¥¼ ì •ë¦¬í•˜ê¸°ìœ„í•´ ì²«ë²ˆì§¸ ë Œë”ë§ìœ¼ë¡œ ì˜¬ë¼ê°€ì„œ `createConnection('general')`ë¡œ ìƒì„±ëœ connectionì— ëŒ€í•´ `disconnect()`ë¥¼ í˜¸ì¶œí•¨
```jsx
// ì„¸ ë²ˆì§¸ ë Œë”ë§ì˜ JSX (roomId = "travel")
return <h1>Welcome to travel!</h1>;

// ì„¸ ë²ˆì§¸ ë Œë”ë§ì˜ íš¨ê³¼(Effect) (roomId = "travel")
() => {
  const connection = createConnection('travel');
  connection.connect();
  return () => connection.disconnect();
},
// ì„¸ ë²ˆì§¸ ë Œë”ë§ì˜ ì¢…ì†ì„±(dependencies) (roomId = "travel")
['travel']
```

4. ì‚¬ìš©ìê°€ ë‹¤ë¥¸ ê³³ìœ¼ë¡œ ì´ë™í• ë•Œ
- ì»´í¬ë„ŒíŠ¸ê°€ ì–¸ë§ˆìš´íŠ¸(ì œê±°)ë˜ë©° ë§ˆì§€ë§‰ Effect(ì„¸ë²ˆì§¸ ë Œë”ë§ì˜ Effect)ì˜ clean-upí•¨ìˆ˜ ì‹¤í–‰

# ë¶ˆí•„ìš”í•œ Effect ì œê±°í•˜ê¸°
---
https://reactnext-central.xyz/docs/react/escape-hatches/you-might-not-need-an-effect